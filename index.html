<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¢…í•© ê±´ê°• ë¶„ì„ê¸° v9 (AI ì¡°ì–¸ê°€)</title>

    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            background-color: #f4f7f6;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh; 
            padding: 2rem 0;
        }
        .calculator-card {
            background-color: #ffffff;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            width: 90%;
            max-width: 450px;
            min-height: 500px; 
            box-sizing: border-box;
            /* í˜ì´ì§€ ì „í™˜ íš¨ê³¼ */
            overflow: hidden; 
        }
        .page-section { display: none; }
        h1 { color: #333; font-size: 1.5rem; text-align: center; margin-bottom: 0.5rem; }

        /* --- ğŸ¨ v9 'ì•ˆë‚´ ë¬¸êµ¬' ìŠ¤íƒ€ì¼ (ì…°í”„ë‹˜ ìš”ì²­!) --- */
        .guidance-text {
            font-size: 0.95rem;
            color: #555;
            text-align: center;
            margin-bottom: 2rem;
            min-height: 40px; /* íƒ€ì´í•‘ ì‹œ ë ˆì´ì•„ì›ƒ í”ë“¤ë¦¼ ë°©ì§€ */
        }
        
        /* (v8 ìŠ¤íƒ€ì¼ ì¬ì‚¬ìš©) */
        .input-group { margin-bottom: 1.25rem; }
        .input-group label { display: block; margin-bottom: 0.5rem; color: #555; font-weight: 600; }
        .input-group input { width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; font-size: 1rem; }
        .food-item { display: flex; justify-content: space-between; align-items: center; padding: 0.75rem 0.25rem; border-bottom: 1px solid #f0f0f0; }
        .food-name { font-size: 1rem; color: #333; }
        .food-counter { display: flex; align-items: center; }
        .counter-btn { width: 32px; height: 32px; border: none; border-radius: 16px; font-size: 1.5rem; font-weight: 600; cursor: pointer; line-height: 30px; transition: opacity 0.2s; }
        .btn-minus { background-color: #eef0f2; color: #555; }
        .btn-plus { background-color: #007aff; color: white; }
        .count-display { font-size: 1.1rem; font-weight: 700; color: #333; margin: 0 0.75rem; min-width: 20px; text-align: center; }
        .nav-buttons { display: flex; justify-content: space-between; margin-top: 2.5rem; }
        .nav-btn { padding: 0.75rem 1.25rem; border: none; border-radius: 8px; font-size: 1rem; font-weight: 700; cursor: pointer; transition: background-color 0.2s; }
        .btn-prev { background-color: #6c757d; color: white; }
        .btn-next { background-color: #007aff; color: white; }
        .btn-submit { background-color: #28a745; color: white; width: 100%; }
        .btn-restart { background-color: #007aff; color: white; width: 100%; }
        
        /* (v8 ê²°ê³¼ ë°•ìŠ¤ ìŠ¤íƒ€ì¼) */
        .result-box { margin-top: 1.5rem; padding: 1rem; background-color: #f8f8f8; border: 1px solid #eee; border-radius: 8px; text-align: center; color: #333; display: none; }
        .bmi-value, .sugar-value, .calorie-value { font-size: 1.1rem; font-weight: 600; display: block; margin-bottom: 0.5rem; }
        .bmi-status, .sugar-status, .calorie-status { font-size: 1.2rem; font-weight: 700; display: block; }
        .status-underweight { color: #007aff; } .status-normal, .status-good { color: #34c759; } .status-overweight, .status-warning { color: #ff9500; } .status-obese, .status-danger { color: #ff3b30; }

        /* --- ğŸ¨ v9 'ì¢…í•© ë¶„ì„' ë°•ìŠ¤ ìŠ¤íƒ€ì¼ (ì…°í”„ë‹˜ ìš”ì²­!) --- */
        #analysis-result-area {
            background-color: #e6f7ff; /* ì—°í•œ íŒŒë€ìƒ‰ ë°°ê²½ */
            border: 1px solid #007aff; /* íŒŒë€ìƒ‰ í…Œë‘ë¦¬ */
            padding: 1.25rem;
        }
        #analysis-result-area h3 {
            margin: 0 0 1rem 0;
            color: #005bb5;
            text-align: center;
        }
        #analysis-result-area p {
            font-size: 0.95rem;
            color: #333;
            margin: 0.5rem 0;
            text-align: left; /* ì¡°ì–¸ì€ ì™¼ìª½ ì •ë ¬ */
        }
    </style>
</head>

<body>

    <div class="calculator-card">

        <div id="page-bmi" class="page-section">
            <h1>[1/9] ì‹ ì²´ ì •ë³´</h1>
            <p id="guidance-bmi" class="guidance-text"></p>
            
            <div class="input-group">
                <label for="height">í‚¤ (cm):</label>
                <input type="text" id="height" inputmode="numeric" maxlength="3" oninput="validateInput(this)" placeholder=" ">
            </div>
            <div class="input-group">
                <label for="weight">ëª¸ë¬´ê²Œ (kg):</label>
                <input type="text" id="weight" inputmode="numeric" maxlength="3" oninput="validateInput(this)" placeholder=" ">
            </div>
            <div class="nav-buttons">
                <button class="nav-btn btn-next" style="width: 100%;" onclick="showPage('page-sugar')">ë‹¤ìŒ (í˜ˆë‹¹)</button>
            </div>
        </div>

        <div id="page-sugar" class="page-section">
            <h1>[2/9] ê³µë³µ í˜ˆë‹¹</h1>
            <p id="guidance-sugar" class="guidance-text"></p>

            <div class="input-group">
                <label for="blood-sugar">ê³µë³µ í˜ˆë‹¹ (mg/dL):</label>
                <input type="text" id="blood-sugar" inputmode="numeric" maxlength="3" oninput="validateInput(this)" placeholder=" ">
            </div>
            <div class="nav-buttons">
                <button class="nav-btn btn-prev" onclick="showPage('page-bmi')">ì´ì „</button>
                <button class="nav-btn btn-next" onclick="showPage('page-breakfast')">ë‹¤ìŒ (ì•„ì¹¨)</button>
            </div>
        </div>

        <div id="page-breakfast" class="page-section">
            <h1>[3/9] ì•„ì¹¨ ì‹ë‹¨</h1>
            <p id="guidance-breakfast" class="guidance-text"></p>
            
            <div class="food-item"><span class="food-name">í† ìŠ¤íŠ¸ 1ìª½(180)</span><div class="food-counter"><button class="counter-btn btn-minus" onclick="decreaseCount('breakfast', 'toast')">-</button><span id="count-breakfast-toast" class="count-display">0</span><button class="counter-btn btn-plus" onclick="increaseCount('breakfast', 'toast')">+</button></div></div>
            <div class="food-item"><span class="food-name">ê³„ë€í›„ë¼ì´(120)</span><div class="food-counter"><button class="counter-btn btn-minus" onclick="decreaseCount('breakfast', 'egg_fry')">-</button><span id="count-breakfast-egg_fry" class="count-display">0</span><button class="counter-btn btn-plus" onclick="increaseCount('breakfast', 'egg_fry')">+</button></div></div>
            <div class="food-item"><span class="food-name">ì‹œë¦¬ì–¼ 1íšŒ(150)</span><div class="food-counter"><button class="counter-btn btn-minus" onclick="decreaseCount('breakfast', 'cereal')">-</button><span id="count-breakfast-cereal" class="count-display">0</span><button class="counter-btn btn-plus" onclick="increaseCount('breakfast', 'cereal')">+</button></div></div>
            <div class="food-item"><span class="food-name">ìš°ìœ  1ì»µ(125)</span><div class="food-counter"><button class="counter-btn btn-minus" onclick="decreaseCount('breakfast', 'milk')">-</button><span id="count-breakfast-milk" class="count-display">0</span><button class="counter-btn btn-plus" onclick="increaseCount('breakfast', 'milk')">+</button></div></div>
            <div class="food-item"><span class="food-name">ì‚¬ê³¼ 1ê°œ(95)</span><div class="food-counter"><button class="counter-btn btn-minus" onclick="decreaseCount('breakfast', 'apple')">-</button><span id="count-breakfast-apple" class="count-display">0</span><button class="counter-btn btn-plus" onclick="increaseCount('breakfast', 'apple')">+</button></div></div>
            
            <div class="nav-buttons">
                <button class="nav-btn btn-prev" onclick="showPage('page-sugar')">ì´ì „</button>
                <button class="nav-btn btn-next" onclick="showPage('page-morningsnack')">ë‹¤ìŒ (ì˜¤ì „ê°„ì‹)</button>
            </div>
        </div>

        <div id="page-morningsnack" class="page-section">
            <h1>[4/9] ì˜¤ì „ ê°„ì‹</h1>
            <p id="guidance-morningsnack" class="guidance-text"></p>
            
            <div class="food-item"><span class="food-name">ì•„ë©”ë¦¬ì¹´ë…¸(10)</span><div class="food-counter"><button class="counter-btn btn-minus" onclick="decreaseCount('morningsnack', 'americano')">-</button><span id="count-morningsnack-americano" class="count-display">0</span><button class="counter-btn btn-plus" onclick="increaseCount('morningsnack', 'americano')">+</button></div></div>
            <div class="food-item"><span class="food-name">ì¹´í˜ë¼ë–¼(180)</span><div class="food-counter"><button class="counter-btn btn-minus" onclick="decreaseCount('morningsnack', 'latte')">-</button><span id="count-morningsnack-latte" class="count-display">0</span><button class="counter-btn btn-plus" onclick="increaseCount('morningsnack', 'latte')">+</button></div></div>
            <div class="food-item"><span class="food-name">ë°”ë‚˜ë‚˜ 1ê°œ(105)</span><div class="food-counter"><button class="counter-btn btn-minus" onclick="decreaseCount('morningsnack', 'banana')">-</button><span id="count-morningsnack-banana" class="count-display">0</span><button class="counter-btn btn-plus" onclick="increaseCount('morningsnack', 'banana')">+</button></div></div>
            <div class="food-item"><span class="food-name">ê²¬ê³¼ë¥˜ í•œ ì¤Œ(160)</span><div class="food-counter"><button class="counter-btn btn-minus" onclick="decreaseCount('morningsnack', 'nuts')">-</button><span id="count-morningsnack-nuts" class="count-display">0</span><button class="counter-btn btn-plus" onclick="increaseCount('morningsnack', 'nuts')">+</button></div></div>

            <div class="nav-buttons">
                <button class="nav-btn btn-prev" onclick="showPage('page-breakfast')">ì´ì „</button>
                <button class="nav-btn btn-next" onclick="showPage('page-lunch')">ë‹¤ìŒ (ì ì‹¬)</button>
            </div>
        </div>

        <div id="page-lunch" class="page-section">
            <h1>[5/9] ì ì‹¬ ì‹ë‹¨</h1>
            <p id="guidance-lunch" class="guidance-text"></p>
            
            <div class="food-item"><span class="food-name">ë°¥ í•œê³µê¸°(300)</span><div class="food-counter"><button class="counter-btn btn-minus" onclick="decreaseCount('lunch', 'rice')">-</button><span id="count-lunch-rice" class="count-display">0</span><button class="counter-btn btn-plus" onclick="increaseCount('lunch', 'rice')">+</button></div></div>
            <div class="food-item"><span class="food-name">ê¹€ì¹˜ì°Œê°œ(450)</span><div class="food-counter"><button class="counter-btn btn-minus" onclick="decreaseCount('lunch', 'kimchi_jjigae')">-</button><span id="count-lunch-kimchi_jjigae" class="count-display">0</span><button class="counter-btn btn-plus" onclick="increaseCount('lunch', 'kimchi_jjigae')">+</button></div></div>
            <div class="food-item"><span class="food-name">ì œìœ¡ë³¶ìŒ(550)</span><div class="food-counter"><button class="counter-btn btn-minus" onclick="decreaseCount('lunch', 'jeyuk_bokkeum')">-</button><span id="count-lunch-jeyuk_bokkeum" class="count-display">0</span><button class="counter-btn btn-plus" onclick="increaseCount('lunch', 'jeyuk_bokkeum')">+</button></div></div>
            <div class="food-item"><span class="food-name">ê³„ë€í›„ë¼ì´(120)</span><div class="food-counter"><button class="counter-btn btn-minus" onclick="decreaseCount('lunch', 'egg_fry')">-</button><span id="count-lunch-egg_fry" class="count-display">0</span><button class="counter-btn btn-plus" onclick="increaseCount('lunch', 'egg_fry')">+</button></div></div>
            <div class="food-item"><span class="food-name">ê¸°ë³¸ ìƒëŸ¬ë“œ(150)</span><div class="food-counter"><button class="counter-btn btn-minus" onclick="decreaseCount('lunch', 'salad')">-</button><span id="count-lunch-salad" class="count-display">0</span><button class="counter-btn btn-plus" onclick="increaseCount('lunch', 'salad')">+</button></div></div>
            
            <div class="nav-buttons">
                <button class="nav-btn btn-prev" onclick="showPage('page-morningsnack')">ì´ì „</button>
                <button class="nav-btn btn-next" onclick="showPage('page-afternoonsnack')">ë‹¤ìŒ (ì˜¤í›„ê°„ì‹)</button>
            </div>
        </div>
        
        <div id="page-afternoonsnack" class="page-section">
            <h1>[6/9] ì˜¤í›„ ê°„ì‹</h1>
            <p id="guidance-afternoonsnack" class="guidance-text"></p>
            
            <div class="food-item"><span class="food-name">ì•„ë©”ë¦¬ì¹´ë…¸(10)</span><div class="food-counter"><button class="counter-btn btn-minus" onclick="decreaseCount('afternoonsnack', 'americano')">-</button><span id="count-afternoonsnack-americano" class="count-display">0</span><button class="counter-btn btn-plus" onclick="increaseCount('afternoonsnack', 'americano')">+</button></div></div>
            <div class="food-item"><span class="food-name">ì¹´í˜ë¼ë–¼(180)</span><div class="food-counter"><button class="counter-btn btn-minus" onclick="decreaseCount('afternoonsnack', 'latte')">-</button><span id="count-afternoonsnack-latte" class="count-display">0</span><button class="counter-btn btn-plus" onclick="increaseCount('afternoonsnack', 'latte')">+</button></div></div>
            <div class="food-item"><span class="food-name">ë°”ë‚˜ë‚˜ 1ê°œ(105)</span><div class="food-counter"><button class="counter-btn btn-minus" onclick="decreaseCount('afternoonsnack', 'banana')">-</button><span id="count-afternoonsnack-banana" class="count-display">0</span><button class="counter-btn btn-plus" onclick="increaseCount('afternoonsnack', 'banana')">+</button></div></div>
            <div class="food-item"><span class="food-name">ê²¬ê³¼ë¥˜ í•œ ì¤Œ(160)</span><div class="food-counter"><button class="counter-btn btn-minus" onclick="decreaseCount('afternoonsnack', 'nuts')">-</button><span id="count-afternoonsnack-nuts" class="count-display">0</span><button class="counter-btn btn-plus" onclick="increaseCount('afternoonsnack', 'nuts')">+</button></div></div>

            <div class="nav-buttons">
                <button class="nav-btn btn-prev" onclick="showPage('page-lunch')">ì´ì „</button>
                <button class="nav-btn btn-next" onclick="showPage('page-dinner')">ë‹¤ìŒ (ì €ë…)</button>
            </div>
        </div>

        <div id="page-dinner" class="page-section">
            <h1>[7/9] ì €ë… ì‹ë‹¨</h1>
            <p id="guidance-dinner" class="guidance-text"></p>
            
            <div class="food-item"><span class="food-name">ë°¥ í•œê³µê¸°(300)</span><div class="food-counter"><button class="counter-btn btn-minus" onclick="decreaseCount('dinner', 'rice')">-</button><span id="count-dinner-rice" class="count-display">0</span><button class="counter-btn btn-plus" onclick="increaseCount('dinner', 'rice')">+</button></div></div>
            <div class="food-item"><span class="food-name">ë‹­ê°€ìŠ´ì‚´(165)</span><div class="food-counter"><button class="counter-btn btn-minus" onclick="decreaseCount('dinner', 'chicken_breast')">-</button><span id="count-dinner-chicken_breast" class="count-display">0</span><button class="counter-btn btn-plus" onclick="increaseCount('dinner', 'chicken_breast')">+</button></div></div>
            <div class="food-item"><span class="food-name">ê¸°ë³¸ ìƒëŸ¬ë“œ(150)</span><div class="food-counter"><button class="counter-btn btn-minus" onclick="decreaseCount('dinner', 'salad')">-</button><span id="count-dinner-salad" class="count-display">0</span><button class="counter-btn btn-plus" onclick="increaseCount('dinner', 'salad')">+</button></div></div>
            <div class="food-item"><span class="food-name">ì œìœ¡ë³¶ìŒ(550)</span><div class="food-counter"><button class="counter-btn btn-minus" onclick="decreaseCount('dinner', 'jeyuk_bokkeum')">-</button><span id="count-dinner-jeyuk_bokkeum" class="count-display">0</span><button class="counter-btn btn-plus" onclick="increaseCount('dinner', 'jeyuk_bokkeum')">+</button></div></div>
            <div class="food-item"><span class="food-name">ê¹€ì¹˜ì°Œê°œ(450)</span><div class="food-counter"><button class="counter-btn btn-minus" onclick="decreaseCount('dinner', 'kimchi_jjigae')">-</button><span id="count-dinner-kimchi_jjigae" class="count-display">0</span><button class="counter-btn btn-plus" onclick="increaseCount('dinner', 'kimchi_jjigae')">+</button></div></div>

            <div class="nav-buttons">
                <button class="nav-btn btn-prev" onclick="showPage('page-afternoonsnack')">ì´ì „</button>
                <button class="nav-btn btn-next" onclick="showPage('page-nightsnack')">ë‹¤ìŒ (ì•¼ì‹)</button>
            </div>
        </div>

        <div id="page-nightsnack" class="page-section">
            <h1>[8/9] ì•¼ì‹ ì‹ë‹¨</h1>
            <p id="guidance-nightsnack" class="guidance-text"></p>
            
            <div class="food-item"><span class="food-name">ë¼ë©´ 1ë´‰(550)</span><div class="food-counter"><button class="counter-btn btn-minus" onclick="decreaseCount('nightsnack', 'ramen')">-</button><span id="count-nightsnack-ramen" class="count-display">0</span><button class="counter-btn btn-plus" onclick="increaseCount('nightsnack', 'ramen')">+</button></div></div>
            <div class="food-item"><span class="food-name">ìš°ìœ  1ì»µ(125)</span><div class="food-counter"><button class="counter-btn btn-minus" onclick="decreaseCount('nightsnack', 'milk')">-</button><span id="count-nightsnack-milk" class="count-display">0</span><button class="counter-btn btn-plus" onclick="increaseCount('nightsnack', 'milk')">+</button></div></div>
            <div class="food-item"><span class="food-name">ê²¬ê³¼ë¥˜ í•œ ì¤Œ(160)</span><div class="food-counter"><button class="counter-btn btn-minus" onclick="decreaseCount('nightsnack', 'nuts')">-</button><span id="count-nightsnack-nuts" class="count-display">0</span><button class="counter-btn btn-plus" onclick="increaseCount('nightsnack', 'nuts')">+</button></div></div>

            <div class="nav-buttons">
                <button class="nav-btn btn-prev" onclick="showPage('page-dinner')">ì´ì „</button>
                <button class="nav-btn btn-submit" onclick="showFinalResults()">ì¢…í•© ê²°ê³¼ í™•ì¸</button>
            </div>
        </div>
        
        <div id="page-results" class="page-section">
            <h1>[9/9] ì¢…í•© ê²°ê³¼</h1>
            <p id="guidance-results" class="guidance-text"></p>
            
            <div id="analysis-result-area" class="result-box">
                </div>
            
            <div id="bmi-result-area" class="result-box"></div>
            <div id="sugar-result-area" class="result-box"></div>
            <div id="calorie-result-area" class="result-box"></div>
            
            <div class="nav-buttons">
                <button class="nav-btn btn-restart" onclick="restartApp()">ì²˜ìŒìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
            </div>
        </div>
        
    </div> <script>
        
        // --- ğŸ§  v9 'ìŠ¤ë§ˆíŠ¸ ëƒ‰ì¥ê³ ' (ì…°í”„ë‹˜ ìš”ì²­!) ---
        // (ìŒì‹ì˜ 'ì†ì„±(íƒœê·¸)'ì„ ì½”ë”©)
        const foodDatabase = {
            // ì•„ì¹¨
            'toast': { kcal: 180, tags: ['high_carb', 'processed'] },
            'egg_fry': { kcal: 120, tags: ['high_protein', 'high_fat'] },
            'cereal': { kcal: 150, tags: ['high_carb', 'high_sugar', 'processed'] },
            'milk': { kcal: 125, tags: ['high_protein', 'high_fat'] },
            'apple': { kcal: 95, tags: ['fruit', 'high_sugar', 'fiber'] },
            // ê°„ì‹
            'americano': { kcal: 10, tags: ['beverage'] },
            'latte': { kcal: 180, tags: ['beverage', 'high_sugar', 'high_fat'] },
            'banana': { kcal: 105, tags: ['fruit', 'high_sugar', 'high_carb'] },
            'nuts': { kcal: 160, tags: ['snack', 'high_fat'] },
            // ì ì‹¬/ì €ë…
            'rice': { kcal: 300, tags: ['high_carb'] },
            'kimchi_jjigae': { kcal: 450, tags: ['high_sodium', 'high_fat', 'spicy'] },
            'jeyuk_bokkeum': { kcal: 550, tags: ['high_protein', 'high_fat', 'high_sodium', 'spicy'] },
            'salad': { kcal: 150, tags: ['fiber', 'low_kcal'] },
            'chicken_breast': { kcal: 165, tags: ['high_protein', 'low_fat', 'low_kcal'] },
            // ì•¼ì‹
            'ramen': { kcal: 550, tags: ['high_carb', 'high_fat', 'high_sodium', 'processed'] }
        };

        // --- ğŸ§  v9 'ë¼ë‹ˆë³„ ë©”ë‰´íŒ' (ì…°í”„ë‹˜ ìš”ì²­!) ---
        // (ê° í˜ì´ì§€ì— ë³´ì—¬ì¤„ ìŒì‹ ëª©ë¡ì„ ì •ì˜)
        const foodMenus = {
            'breakfast': ['toast', 'egg_fry', 'cereal', 'milk', 'apple'],
            'morningsnack': ['americano', 'latte', 'banana', 'nuts'],
            'lunch': ['rice', 'kimchi_jjigae', 'jeyuk_bokkeum', 'egg_fry', 'salad'],
            'afternoonsnack': ['americano', 'latte', 'banana', 'nuts'],
            'dinner': ['rice', 'chicken_breast', 'salad', 'jeyuk_bokkeum', 'kimchi_jjigae'],
            'nightsnack': ['ramen', 'milk', 'nuts']
        };

        // --- ğŸ§  v9 'ì•ˆë‚´ ë¬¸êµ¬' ëª©ë¡ (ì…°í”„ë‹˜ ìš”ì²­!) ---
        const guidanceMessages = {
            'page-bmi': "ì…°í”„ë‹˜ì˜ ê¸°ë³¸ ì‹ ì²´ ìƒíƒœ(BMI)ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.",
            'page-sugar': "í˜ˆë‹¹ì€ ì‹ë‹¨ ì¡°ì–¸ì— ì¤‘ìš”í•œ ê¸°ì¤€ì´ ë©ë‹ˆë‹¤.",
            'page-breakfast': "í•˜ë£¨ë¥¼ ì‹œì‘í•˜ëŠ” ì•„ì¹¨ ì‹ì‚¬ë¥¼ ê¸°ë¡í•´ ì£¼ì„¸ìš”.",
            'page-morningsnack': "ì˜¤ì „ì— ë“œì‹  ê°„ì‹ì´ ìˆë‚˜ìš”?",
            'page-lunch': "ê°€ì¥ ë“ ë“ í•œ ì ì‹¬ ì‹ì‚¬ë¥¼ ê¸°ë¡í•´ ì£¼ì„¸ìš”.",
            'page-afternoonsnack': "ì˜¤í›„ì— ë“œì‹  ê°„ì‹ì´ ìˆë‚˜ìš”?",
            'page-dinner': "í•˜ë£¨ë¥¼ ë§ˆë¬´ë¦¬í•˜ëŠ” ì €ë… ì‹ì‚¬ì…ë‹ˆë‹¤.",
            'page-nightsnack': "í˜¹ì‹œ... ì•¼ì‹ì„ ë“œì…¨ë‚˜ìš”? (ì†”ì§í•˜ê²Œ!)",
            'page-results': "ëª¨ë“  ë°ì´í„°ë¥¼ ì·¨í•©í•œ ì¢…í•© ë¶„ì„ ê²°ê³¼ì…ë‹ˆë‹¤."
        };

        // --- (v8 ì¬ì‚¬ìš©: ì¹´ìš´í„° í•¨ìˆ˜) ---
        function increaseCount(mealTime, foodId) {
            let countElement = document.getElementById('count-' + mealTime + '-' + foodId);
            let currentCount = parseInt(countElement.innerText);
            currentCount++;
            countElement.innerText = currentCount;
        }
        function decreaseCount(mealTime, foodId) {
            let countElement = document.getElementById('count-' + mealTime + '-' + foodId);
            let currentCount = parseInt(countElement.innerText);
            if (currentCount > 0) { currentCount--; }
            countElement.innerText = currentCount;
        }

        // --- (v8 ì¬ì‚¬ìš©: ì…ë ¥ ê°ì‹œê´€) ---
        function validateInput(element) {
            element.value = element.value.replace(/[^0-9]/g, '');
        }

        // --- (v8 ì—…ê·¸ë ˆì´ë“œ: íƒ€ì´í•‘ íš¨ê³¼) ---
        let currentTypingTimer; // í˜„ì¬ íƒ€ì´í•‘ íƒ€ì´ë¨¸

        // (elementIdì˜ placeholder ë˜ëŠ” innerHTMLì— íƒ€ì´í•‘)
        function typeEffect(elementId, text, speed = 70, isPlaceholder = false, callback = null) {
            const element = document.getElementById(elementId);
            if (!element) return;
            
            let i = 0;
            if (isPlaceholder) element.placeholder = '';
            else element.innerHTML = '';

            function type() {
                if (i < text.length) {
                    let char = text.charAt(i);
                    if (isPlaceholder) element.placeholder += char;
                    else element.innerHTML += char;
                    i++;
                    currentTypingTimer = setTimeout(type, speed);
                } else if (callback) {
                    callback(); // íƒ€ì´í•‘ ì™„ë£Œ í›„ ì½œë°± ì‹¤í–‰
                }
            }
            type();
        }

        // --- (v8 ì—…ê·¸ë ˆì´ë“œ: í˜ì´ì§€ ë§ˆìˆ ì‚¬) ---
        function showPage(pageId) {
            // 1. ê¸°ì¡´ íƒ€ì´í•‘ ì¤‘ì§€
            clearTimeout(currentTypingTimer);

            // 2. ëª¨ë“  í˜ì´ì§€ ìˆ¨ê¸°ê¸°
            const allPages = document.querySelectorAll('.page-section');
            allPages.forEach(page => { page.style.display = 'none'; });
            
            // 3. ëŒ€ìƒ í˜ì´ì§€ë§Œ ë³´ì—¬ì£¼ê¸°
            const targetPage = document.getElementById(pageId);
            if (targetPage) { targetPage.style.display = 'block'; }

            // 4. v9: í˜ì´ì§€ë³„ 'ì•ˆë‚´ ë¬¸êµ¬' íƒ€ì´í•‘ ì‹œì‘
            const guidanceId = 'guidance-' + pageId.split('-')[1]; // ì˜ˆ: 'guidance-bmi'
            if (guidanceMessages[pageId]) {
                typeEffect(guidanceId, guidanceMessages[pageId], 50); // ì•ˆë‚´ ë¬¸êµ¬ëŠ” ì¡°ê¸ˆ ë¹ ë¥´ê²Œ
            }

            // 5. v8: 'ì…ë ¥ë€' íƒ€ì´í•‘ ì‹œì‘ (í•´ë‹¹ë˜ëŠ” ê²½ìš°)
            if (pageId === 'page-bmi') {
                typeEffect('height', 'ì˜ˆ: 170', 100, true, () => {
                    typeEffect('weight', 'ì˜ˆ: 65', 100, true);
                });
            } else if (pageId === 'page-sugar') {
                typeEffect('blood-sugar', 'ì˜ˆ: 95', 100, true);
            }
        }

        // --- ğŸ†• v9 'ë©”ì¸ ê³„ì‚° (ë¶„ì„ ì—”ì§„)' í•¨ìˆ˜ ---
        function showFinalResults() {
            // 1. ê¸°ë³¸ ê°’ ê°€ì ¸ì˜¤ê¸°
            let heightCm = parseFloat(document.getElementById('height').value) || 0;
            let weightKg = parseFloat(document.getElementById('weight').value) || 0;
            let bloodSugar = parseFloat(document.getElementById('blood-sugar').value) || 0;
            
            // 2. ê²°ê³¼ ë°•ìŠ¤ DOM ê°€ì ¸ì˜¤ê¸°
            let bmiDiv = document.getElementById('bmi-result-area');
            let sugarDiv = document.getElementById('sugar-result-area');
            let calorieDiv = document.getElementById('calorie-result-area');
            let analysisDiv = document.getElementById('analysis-result-area'); // ğŸ†• v9 ë¶„ì„ ë°•ìŠ¤

            // 3. BMI ê³„ì‚° ë° í‘œì‹œ
            let bmi = 0;
            if (heightCm > 0 && weightKg > 0) {
                let heightM = heightCm / 100;
                bmi = (weightKg / (heightM * heightM)); // ì¡°ì–¸ì„ ìœ„í•´ ì†Œìˆ˜ì  ë‚¨ê¹€
                let statusMessage = "", statusClass = "";
                if (bmi < 18.5) { statusMessage = "ì €ì²´ì¤‘ì…ë‹ˆë‹¤. ğŸ˜¢"; statusClass = "status-underweight"; }
                else if (bmi >= 18.5 && bmi <= 22.9) { statusMessage = "ì •ìƒ ì²´ì¤‘ì…ë‹ˆë‹¤! ğŸ‘"; statusClass = "status-normal"; }
                else if (bmi >= 23 && bmi <= 24.9) { statusMessage = "ê³¼ì²´ì¤‘ì…ë‹ˆë‹¤. ğŸ˜Ÿ"; statusClass = "status-overweight"; }
                else { statusMessage = "ë¹„ë§Œì…ë‹ˆë‹¤. ğŸš¨"; statusClass = "status-obese"; }
                bmiDiv.innerHTML = `<span class='bmi-value'>ë‹¹ì‹ ì˜ BMIëŠ” <strong>${bmi.toFixed(2)}</strong> ì…ë‹ˆë‹¤.</span><span class='bmi-status ${statusClass}'>${statusMessage}</span>`;
                bmiDiv.style.display = "block";
            } else { bmiDiv.style.display = "none"; }

            // 4. í˜ˆë‹¹ ê³„ì‚° ë° í‘œì‹œ
            if (bloodSugar > 0) {
                let sugarMessage = "", sugarClass = "";
                if (bloodSugar < 100) { sugarMessage = "ê³µë³µ í˜ˆë‹¹ì´ 'ì •ìƒ'ì…ë‹ˆë‹¤. ğŸ‘"; sugarClass = "status-good"; }
                else if (bloodSugar >= 100 && bloodSugar <= 119) { sugarMessage = "ê³µë³µ í˜ˆë‹¹ 'ê²½ê³„'ì…ë‹ˆë‹¤. âš ï¸"; sugarClass = "status-warning"; }
                else { sugarMessage = "ê³µë³µ í˜ˆë‹¹ 'ìœ„í—˜'ì…ë‹ˆë‹¤! ğŸš¨"; sugarClass = "status-danger"; }
                sugarDiv.innerHTML = `<span class='sugar-value'>ê³µë³µ í˜ˆë‹¹: <strong>${bloodSugar}</strong> mg/dL</span><span class='sugar-status ${sugarClass}'>${sugarMessage}</span>`;
                sugarDiv.style.display = "block";
            } else { sugarDiv.style.display = "none"; }
            
            // 5. ì¹¼ë¡œë¦¬ & íƒœê·¸ ìˆ˜ì§‘
            let totalCalories = 0;
            let allTags = [];
            
            // v9 'ë¼ë‹ˆë³„ ë©”ë‰´íŒ'ì„ ê¸°ë°˜ìœ¼ë¡œ ìˆœíšŒ (v8.1 ìˆ˜ì •ë¨)
            for (const meal in foodMenus) { // 'breakfast', 'lunch' ë“±
                for (const food of foodMenus[meal]) { // 'rice', 'toast' ë“±
                    const count = parseInt(document.getElementById(`count-${meal}-${food}`).innerText);
                    if (count > 0) {
                        totalCalories += (foodDatabase[food].kcal * count);
                        allTags.push(...foodDatabase[food].tags); // é£Ÿã¹ãŸå›æ•°åˆ†ã‚¿ã‚°ã‚’è¿½åŠ 
                    }
                }
            }
            
            // 6. ì¹¼ë¡œë¦¬ ê²°ê³¼ í‘œì‹œ
            if (totalCalories > 0) {
                calorieDiv.innerHTML = `<span class='calorie-value'>ì„­ì·¨í•œ ì´ ì¹¼ë¡œë¦¬ëŠ” <strong>${totalCalories}</strong> kcal ì…ë‹ˆë‹¤.</span>`;
                if (totalCalories < 1500) { calorieDiv.innerHTML += "<span class='calorie-status status-good'>ì ì ˆí•œ ì„­ì·¨ì…ë‹ˆë‹¤. ğŸ‘</span>"; }
                else if (totalCalories >= 1500 && totalCalories < 2500) { calorieDiv.innerHTML += "<span class='calorie-status status-warning'>ì¡°ê¸ˆ ë§ì•„ìš”! ğŸ˜Ÿ</span>"; }
                else { calorieDiv.innerHTML += "<span class='calorie-status status-danger'>ê³¼ë‹¤ ì„­ì·¨ì…ë‹ˆë‹¤! ğŸš¨</span>"; }
                calorieDiv.style.display = "block";
            } else { calorieDiv.style.display = "none"; }

            // 7. --- ğŸ†• v9 ë¶„ì„ ì—”ì§„ (ì…°í”„ë‹˜ ìš”ì²­!) ---
            let adviceMessages = [];
            const uniqueTags = [...new Set(allTags)]; // ì¤‘ë³µ íƒœê·¸ ì œê±°

            // [BMI] + [ìŒì‹] ì¡°í•© ë¶„ì„
            if (bmi >= 23) { // ê³¼ì²´ì¤‘ ë˜ëŠ” ë¹„ë§Œì¼ ë•Œ
                if (uniqueTags.includes('high_fat') || uniqueTags.includes('processed')) {
                    adviceMessages.push("ğŸš¨ **ì²´ì¤‘ ê´€ë¦¬:** ì²´ì¤‘ì´ 'ê³¼ì²´ì¤‘' ì´ìƒì¸ë°, ì˜¤ëŠ˜ 'ê³ ì§€ë°©' ë˜ëŠ” 'ê°€ê³µì‹í’ˆ'(ë¼ë©´, ì œìœ¡ë³¶ìŒ ë“±)ì„ ë“œì…¨ë„¤ìš”. ì²´ì¤‘ ê´€ë¦¬ì— ì¢‹ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
                }
                if (totalCalories > 2000) {
                     adviceMessages.push("ğŸš¨ **ì¹¼ë¡œë¦¬:** ì²´ì¤‘ ê´€ë¦¬ ì¤‘ì—ëŠ” ì´ ì„­ì·¨ ì¹¼ë¡œë¦¬ë¥¼ ì¡°ì ˆí•  í•„ìš”ê°€ ìˆìŠµë‹ˆë‹¤.");
                }
            }
            // [í˜ˆë‹¹] + [ìŒì‹] ì¡°í•© ë¶„ì„
            if (bloodSugar >= 100) { // í˜ˆë‹¹ ê²½ê³„ ë˜ëŠ” ìœ„í—˜ì¼ ë•Œ
                if (uniqueTags.includes('high_carb') || uniqueTags.includes('high_sugar')) {
                    adviceMessages.push("âš ï¸ **í˜ˆë‹¹ ê´€ë¦¬:** í˜ˆë‹¹ì´ 'ê²½ê³„' ì´ìƒì¸ë°, 'ê³ íƒ„ìˆ˜í™”ë¬¼'(ë°¥, ë¼ë©´, í† ìŠ¤íŠ¸)ì´ë‚˜ 'ë‹¹ë¥˜'(ê³¼ì¼, ë¼ë–¼)ë¥¼ ì„­ì·¨í•˜ì…¨ë„¤ìš”. í˜ˆë‹¹ì— ì§ì ‘ì ì¸ ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
                }
            }
            // [ì¢‹ì€ ì‹ìŠµê´€] ë¶„ì„
            if (uniqueTags.includes('high_protein') && uniqueTags.includes('low_fat')) {
                adviceMessages.push("ğŸ‘ **ì¢‹ì€ ì„ íƒ:** 'ë‹­ê°€ìŠ´ì‚´'ì²˜ëŸ¼ 'ê³ ë‹¨ë°±/ì €ì§€ë°©' ì‹í’ˆì„ ì±™ê²¨ ë“œì…¨êµ°ìš”. í›Œë¥­í•œ ì„ íƒì…ë‹ˆë‹¤!");
            }
            if (uniqueTags.includes('fiber')) {
                adviceMessages.push("ğŸ‘ **ì¢‹ì€ ì„ íƒ:** 'ìƒëŸ¬ë“œ'ë‚˜ 'ì‚¬ê³¼'ì²˜ëŸ¼ 'ì„¬ìœ ì§ˆ'ì´ í’ë¶€í•œ ìŒì‹ì„ ë“œì…¨ë„¤ìš”. ê±´ê°•ì— ì¢‹ìŠµë‹ˆë‹¤.");
            }
            // [ë‚˜ìœ ì‹ìŠµê´€] ë¶„ì„
            if (uniqueTags.includes('high_sodium')) {
                adviceMessages.push("ğŸ§‚ **ë‚˜íŠ¸ë¥¨ ì£¼ì˜:** 'ì°Œê°œ'ë‚˜ 'ë¼ë©´' ë“± 'ê³ ë‚˜íŠ¸ë¥¨' ì‹í’ˆì„ ë“œì…¨ìŠµë‹ˆë‹¤. ì„­ì·¨ë¥¼ ì¤„ì´ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.");
            }
            
            // ìµœì¢… ì¡°ì–¸ ì¢…í•©
            if (adviceMessages.length > 0) {
                analysisDiv.innerHTML = "<h3>ğŸ‘©â€âš•ï¸ ì…°í”„ì˜ ì¢…í•© ë¶„ì„</h3>" + adviceMessages.map(msg => `<p>${msg}</p>`).join('');
            } else if (totalCalories == 0 && bmi == 0 && bloodSugar == 0) {
                 analysisDiv.innerHTML = "<h3>ğŸ‘©â€âš•ï¸ ì…°í”„ì˜ ì¢…í•© ë¶„ì„</h3><p>ì•„ì§ ì…ë ¥ëœ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤. 1ë‹¨ê³„ë¶€í„° ì…ë ¥í•´ ì£¼ì„¸ìš”!</p>";
            } else {
                analysisDiv.innerHTML = "<h3>ğŸ‘©â€âš•ï¸ ì…°í”„ì˜ ì¢…í•© ë¶„ì„</h3><p>ğŸ‰ íŠ¹ë³„í•œ ìœ„í—˜ ì‹ í˜¸ ì—†ì´ ê· í˜• ì¡íŒ ì‹ì‚¬ë¥¼ í•˜ì…¨ìŠµë‹ˆë‹¤! ë©‹ì ¸ìš”!</p>";
            }
            analysisDiv.style.display = "block";
            
            // 8. ë§ˆì§€ë§‰: 9ë‹¨ê³„ 'ê²°ê³¼ í˜ì´ì§€' ë³´ì—¬ì£¼ê¸°
            showPage('page-results');
        }

        // --- ğŸ†• v9 'ì²˜ìŒìœ¼ë¡œ' í•¨ìˆ˜ (v9 ë©”ë‰´íŒì— ë§ê²Œ ìˆ˜ì •) ---
        function restartApp() {
            // 1. 1~2ë‹¨ê³„ ì…ë ¥ ì¹¸ ë¹„ìš°ê¸°
            document.getElementById('height').value = "";
            document.getElementById('weight').value = "";
            document.getElementById('blood-sugar').value = "";
            document.getElementById('height').placeholder = " ";
            document.getElementById('weight').placeholder = " ";
            document.getElementById('blood-sugar').placeholder = " ";

            // 2. 3~8ë‹¨ê³„ 'ëª¨ë“ ' ì¹´ìš´í„°(v9 ë©”ë‰´íŒ ê¸°ì¤€) 0ìœ¼ë¡œ ì´ˆê¸°í™”
            for (const meal in foodMenus) {
                for (const food of foodMenus[meal]) {
                    const el = document.getElementById(`count-${meal}-${food}`);
                    if (el) el.innerText = "0";
                }
            }
            
            // 3. 9ë‹¨ê³„ ê²°ê³¼ ë°•ìŠ¤ ìˆ¨ê¸°ê¸°
            document.getElementById('bmi-result-area').style.display = 'none';
            document.getElementById('sugar-result-area').style.display = 'none';
            document.getElementById('calorie-result-area').style.display = 'none';
            document.getElementById('analysis-result-area').style.display = 'none'; // ğŸ†• v9 ë¶„ì„ ë°•ìŠ¤ ìˆ¨ê¸°ê¸°

            // 4. ë‹¤ì‹œ 1ë‹¨ê³„ í˜ì´ì§€ ë³´ì—¬ì£¼ê¸°
            showPage('page-bmi');
        }

        // --- ğŸ†• v9 ì•± ì‹œì‘! ---
        showPage('page-bmi');
    </script>

</body>
</html>